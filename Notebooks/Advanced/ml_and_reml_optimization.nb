(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     88137,       2430]
NotebookOptionsPosition[     77778,       2248]
NotebookOutlinePosition[     78193,       2265]
CellTagsIndexPosition[     78150,       2262]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", "Synthetic"}]}]}]}]}], " ", "LMM", " ", 
    RowBox[{"data", ":", 
     RowBox[{"2", " ", "groups", " ", "x", " ", "5", " ", "obs", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"each", "--"}], "--"}], "--"}], "--"}], "--"}]}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Group", " ", 
     RowBox[{"labels", ":", 
      RowBox[{"first", " ", "5", " ", "in", " ", "group", " ", "1"}]}]}], ",", 
    RowBox[{"next", " ", "5", " ", "in", " ", "group", " ", "2"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", 
       "2", ",", "2", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Exogenous", " ", "covariate", " ", 
     RowBox[{"(", 
      RowBox[{"common", " ", "slope", " ", "across", " ", "groups"}], ")"}]}],
     "*)"}], 
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.7"}], ",", 
       RowBox[{"-", "0.8"}], ",", 
       RowBox[{"-", "0.2"}], ",", "0.0", ",", "1.5", ",", 
       RowBox[{"-", "1.2"}], ",", 
       RowBox[{"-", "0.5"}], ",", "0.3", ",", "0.9", ",", "1.8"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Design", " ", "matrices"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "x", "]"}]}], "]"}], ",", 
        RowBox[{"N", "@", "x"}]}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Z", "=", 
     RowBox[{"N", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "g", "]"}]}], "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Response", ":", "y"}], "=", 
     RowBox[{
      RowBox[{"X", ".", "beta"}], "+", "bVec", "+", "eps"}]}], "*)"}], 
   RowBox[{
    RowBox[{"y", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.185900"}], ",", "0.422325", ",", "2.355231", ",", 
       "2.151807", ",", "2.421508", ",", "1.260097", ",", "2.042463", ",", 
       "2.888910", ",", "3.165363", ",", "2.413316"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"4", ")"}], " ", "Grouping", " ", "helpers"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"idx1", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Position", "[", 
       RowBox[{"g", ",", "1"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"idx2", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Position", "[", 
       RowBox[{"g", ",", "2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "SD", " ", "and", " ", "variance", " ", "of", " ", "random", " ", 
     "intercepts"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tau", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tau2", "=", 
     RowBox[{"tau", "^", "2"}]}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"sig", "=", "0.6"}], ";", 
    RowBox[{"sig2", "=", 
     RowBox[{"sig", "^", "2"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.969811391259211*^9, 3.969811449219664*^9}, {
  3.96981151760845*^9, 3.969811520853574*^9}, {3.969812804812785*^9, 
  3.969812877160368*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"ff03ce13-002c-4b75-8642-2a17c58b4488"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"X", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9698115344617968`*^9, 3.96981154402756*^9}, {
  3.969811587126835*^9, 3.969811588033526*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"99bb54d2-1ee1-41de-a2e5-fac835bcbda4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", 
      RowBox[{"-", "1.7`"}]},
     {"1.`", 
      RowBox[{"-", "0.8`"}]},
     {"1.`", 
      RowBox[{"-", "0.2`"}]},
     {"1.`", "0.`"},
     {"1.`", "1.5`"},
     {"1.`", 
      RowBox[{"-", "1.2`"}]},
     {"1.`", 
      RowBox[{"-", "0.5`"}]},
     {"1.`", "0.3`"},
     {"1.`", "0.9`"},
     {"1.`", "1.8`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.969811535186954*^9, 3.9698115445807533`*^9}, 
   3.969811588536664*^9},
 CellLabel->
  "Out[11]//MatrixForm=",ExpressionUUID->"4d4f9d77-d2ee-4e7b-ab10-\
47404cb3646e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Z", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9698115803385153`*^9, 3.969811582789431*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"cddd545c-1cea-4429-8e45-fbdfb8e28fe0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", "0.`"},
     {"1.`", "0.`"},
     {"1.`", "0.`"},
     {"1.`", "0.`"},
     {"1.`", "0.`"},
     {"0.`", "1.`"},
     {"0.`", "1.`"},
     {"0.`", "1.`"},
     {"0.`", "1.`"},
     {"0.`", "1.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.969811583331889*^9},
 CellLabel->
  "Out[10]//MatrixForm=",ExpressionUUID->"73f05810-21bd-4367-8169-\
d593d5f18f94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Inverse", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", "X", "]"}], ".", "X"}], "]"}], ".", 
  RowBox[{"Transpose", "[", "X", "]"}], ".", "y"}]], "Input",
 CellChangeTimes->{{3.969811666355691*^9, 3.969811669692492*^9}, {
  3.969811755515697*^9, 3.969811796862329*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"0a639caa-7b65-4b45-9bc6-ba4d30cdb36f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.8862357057258137`", ",", "0.7276294274186627`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.969811671529337*^9, {3.969811757058565*^9, 3.969811773320897*^9}, 
   3.9698118037008257`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"63b14d0d-a3fb-4c09-baca-131d3c1f8338"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Residual", " ", "variance"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalRho]", "=", 
     RowBox[{"sig2", " ", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Length", "[", "y", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"\[CapitalRho]", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.969813011535512*^9, 3.969813021159431*^9}, {
  3.9698132393794813`*^9, 3.9698132415864687`*^9}, {3.9698133925997477`*^9, 
  3.969813415312965*^9}, {3.969813820660686*^9, 3.969813822848547*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"4d2a3f84-6f24-4987-ad1f-af311a64223c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.36`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.36`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.36`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.36`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.36`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.36`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.36`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.36`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.36`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.36`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.969813013543182*^9, 3.9698130216581783`*^9}, 
   3.969813244338727*^9, 3.969813416036618*^9, 3.9698138261964207`*^9},
 CellLabel->
  "Out[57]//MatrixForm=",ExpressionUUID->"0f88cbaa-18cb-49a7-9f08-\
e8dd3bfebf27"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Var", " ", "of", " ", "group", " ", "intercepts"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalTau]", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"tau2", ",", "tau2"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"\[CapitalTau]", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.969813663401075*^9, 3.969813784535576*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"080410b0-6f3b-46fc-838a-3e0c936201c0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.81`", "0.`"},
     {"0.`", "0.81`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9698137714364862`*^9, 3.969813791555819*^9}},
 CellLabel->
  "Out[55]//MatrixForm=",ExpressionUUID->"cd024944-bb7e-473b-934e-\
b007da6daf7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Inverse", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", "X", "]"}], ".", 
    RowBox[{"Inverse", "[", "\[CapitalRho]", "]"}], ".", "X"}], "]"}], ".", 
  RowBox[{"Transpose", "[", "X", "]"}], ".", 
  RowBox[{"Inverse", "[", "\[CapitalRho]", "]"}], ".", "y"}]], "Input",
 CellChangeTimes->{{3.969813923286955*^9, 3.9698139258572493`*^9}, {
  3.969813960495854*^9, 3.969814042583776*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"38bbdf67-469f-455a-bc49-79bf7a0c9daf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.8862357057258132`", ",", "0.7276294274186625`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.969813965560528*^9, 3.969814043245981*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"06c3e523-79be-4c9a-87b3-eb4d860fe758"]
}, Open  ]],

Cell[TextData[{
 "This encodes \[OpenCurlyDoubleQuote]variance\[CloseCurlyDoubleQuote] ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox["\[Tau]", "2"], "+", 
         SuperscriptBox["\[Sigma]", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\tau^2 + \\sigma^2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "faac13f0-375b-4d40-8298-6051104d042c"],
 " on the diagonal and \[OpenCurlyDoubleQuote]covariance\
\[CloseCurlyDoubleQuote] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        SuperscriptBox["\[Tau]", "2"], TraditionalForm], "errors" -> {}, 
      "input" -> "\\tau^2", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], " "}], TraditionalForm]],ExpressionUUID->
  "d380071b-413f-4112-ad45-22e7448ba6a9"],
 " off-diagonal."
}], "Text",
 CellChangeTimes->{{3.969814495674685*^9, 
  3.9698145659563007`*^9}},ExpressionUUID->"c8450167-f137-4284-a93b-\
d2b508871c78"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{
    RowBox[{"Z", ".", "\[CapitalTau]", ".", 
     RowBox[{"Transpose", "[", "Z", "]"}]}], "+", "\[CapitalRho]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"V", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.96981428642404*^9, 3.969814333039057*^9}, {
  3.969814397575079*^9, 3.9698144155150414`*^9}, {3.96981468192838*^9, 
  3.9698146946577263`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"e8903ba3-0ca3-49d8-893e-d51f85d8ecce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.17`", "0.81`", "0.81`", "0.81`", "0.81`", "0.`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.81`", "1.17`", "0.81`", "0.81`", "0.81`", "0.`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.81`", "0.81`", "1.17`", "0.81`", "0.81`", "0.`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.81`", "0.81`", "0.81`", "1.17`", "0.81`", "0.`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.81`", "0.81`", "0.81`", "0.81`", "1.17`", "0.`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "1.17`", "0.81`", "0.81`", "0.81`", 
      "0.81`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.81`", "1.17`", "0.81`", "0.81`", 
      "0.81`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.81`", "0.81`", "1.17`", "0.81`", 
      "0.81`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.81`", "0.81`", "0.81`", "1.17`", 
      "0.81`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.81`", "0.81`", "0.81`", "0.81`", 
      "1.17`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.96981429048682*^9, 3.969814333613797*^9}, {
  3.9698144096106443`*^9, 3.969814415981192*^9}, {3.969814690448944*^9, 
  3.969814695711562*^9}},
 CellLabel->
  "Out[75]//MatrixForm=",ExpressionUUID->"4cadd567-5f49-46e3-a912-\
1224da59b98b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "*", 
  RowBox[{"Total", "[", 
   RowBox[{"Log", "[", 
    RowBox[{"Diagonal", "[", 
     RowBox[{"CholeskyDecomposition", "[", "V", "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9698171123041*^9, 3.969817189059062*^9}, {
  3.969817224276984*^9, 3.9698172283969297`*^9}, {3.969817321770142*^9, 
  3.969817323807267*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"28f05bde-de1f-4028-9ee8-5bf3f2122288"],

Cell[BoxData[
 RowBox[{"-", "5.205460601338345`"}]], "Output",
 CellChangeTimes->{3.969817228971265*^9, 3.969817324975707*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"563c981d-6384-4fc4-b65b-26a4cd8125d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{"Det", "[", "V", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.969817287696156*^9, 3.969817301608659*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"e268e2fd-08cb-419d-9bce-942a20bafa03"],

Cell[BoxData[
 RowBox[{"-", "5.205460601338345`"}]], "Output",
 CellChangeTimes->{{3.96981729079451*^9, 3.969817302217681*^9}},
 CellLabel->"Out[91]=",ExpressionUUID->"d729ed15-40cd-4c29-ae4b-8a004874be11"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ML/REML", "Section",
 CellChangeTimes->{{3.9698160794399023`*^9, 3.969816079545951*^9}, {
  3.969876077737494*^9, 
  3.9698760786402617`*^9}},ExpressionUUID->"47ec6724-1f53-4631-bc01-\
3a551bfbf0af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "[", "y", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ng", "=", 
   RowBox[{"Length", "@", 
    RowBox[{"Union", "[", "g", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.969816102147264*^9, 3.9698161075926943`*^9}, {
  3.969816800251073*^9, 3.969816805414068*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"092ccbc9-de54-42f7-a88a-7978f0bd23cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "a"}], ")"}], " ", "Utilities"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Symmetrize", " ", "to", " ", "fight", " ", "tiny", " ", "asymmetries"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SPD", "[", "M_", "]"}], ":=", 
     RowBox[{"0.5", " ", 
      RowBox[{"(", 
       RowBox[{"M", "+", 
        RowBox[{"Transpose", "[", "M", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeV", "[", 
      RowBox[{"tau2_", ",", "sig2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"D", ",", "R"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "=", 
         RowBox[{"tau2", " ", 
          RowBox[{"IdentityMatrix", "[", "ng", "]"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"Var", 
            RowBox[{"(", "b", ")"}]}], "=", 
           RowBox[{
            RowBox[{"\[Tau]", "^", "2"}], " ", "I_ng"}]}], ",", 
          RowBox[{"random", " ", "intercepts"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"sig2", " ", 
          RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Var", 
           RowBox[{"(", "\[CurlyEpsilon]", ")"}]}], "=", 
          RowBox[{
           RowBox[{"\[Sigma]", "^", "2"}], " ", "I_n"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Z", ".", "D", ".", 
          RowBox[{"Transpose", "[", "Z", "]"}]}], "+", "R"}]}]}], "  ", 
      RowBox[{"(*", 
       RowBox[{"V", "=", 
        RowBox[{
         RowBox[{"Z", " ", "D", " ", 
          RowBox[{"Z", "'"}]}], "+", "R"}]}], "*)"}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Stable", " ", "log"}], "|", "SPD", "|", 
     RowBox[{
      RowBox[{"via", " ", "Cholesky", " ", "return"}], "-", 
      RowBox[{"Infinity", " ", "if", " ", "not", " ", "SPD"}]}]}], "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"logDetSPD", "[", "M_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Mm", "=", 
         RowBox[{"SPD", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"Quiet", "@", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"cd", "=", 
              RowBox[{"CholeskyDecomposition", "[", "Mm", "]"}]}], "}"}], ",", 
            RowBox[{"2.0", " ", 
             RowBox[{"Total", "[", 
              RowBox[{"Log", "[", 
               RowBox[{"Diagonal", "[", "cd", "]"}], "]"}], "]"}]}]}], "]"}], 
          ",", 
          RowBox[{"-", "Infinity"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Apply", " ", 
      RowBox[{"V", "^", 
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}]}], " ", "to", " ", 
      RowBox[{"vector", "/", "matrix"}], " ", "rhs", " ", "via", " ", 
      "Cholesky"}], "-", 
     RowBox[{"backed", " ", "solver"}]}], "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"VInvApply", "[", 
      RowBox[{"V_", ",", "rhs_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Vm", "=", 
         RowBox[{"SPD", "[", "V", "]"}]}], "}"}], ",", 
       RowBox[{"Quiet", "@", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"LinearSolve", "[", 
           RowBox[{"Vm", ",", "rhs", ",", 
            RowBox[{"Method", "->", "\"\<Cholesky\>\""}]}], "]"}], ",", 
          "Indeterminate"}], "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.96981682303023*^9, 3.9698168655274677`*^9}, {
   3.969816956008576*^9, 3.9698170884825487`*^9}, {3.969817490926859*^9, 
   3.969817492587665*^9}, {3.969817538299655*^9, 3.969817543254099*^9}, {
   3.969818060949615*^9, 3.9698181143470592`*^9}, 3.969818375489175*^9, {
   3.969819325343053*^9, 3.9698194135081377`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"55e0e461-d078-4105-a82f-261fde17068f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"1", "b"}], ")"}], " ", "GLS", " ", "\[Beta]"}], "-", 
    RowBox[{"hat", " ", "and", " ", "quadratic", " ", "form", " ", 
     RowBox[{"r", "'"}], " ", 
     RowBox[{"V", "^", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], " ", "r", " ", "given", " ", "V"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Beta]\:0302", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", "'"}], 
        RowBox[{"V", "^", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "X"}], ")"}], "^", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], " ", 
     RowBox[{"X", "'"}], 
     RowBox[{"V", "^", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], " ", "y"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "GLS", " ", "\[Beta]\:0302", " ", "and", " ", "residual", " ", "quadratic",
     " ", 
    RowBox[{"r", "'"}], " ", 
    RowBox[{"V", "^", 
     RowBox[{"{", 
      RowBox[{"-", "1"}], "}"}]}], " ", "r", " ", "given", " ", "V"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"glsFromV", "[", "V_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"VinvX", ",", "Vinvy", ",", "betaHat", ",", "r", ",", "quad"}],
        "}"}], ",", 
      RowBox[{
       RowBox[{"VinvX", "=", 
        RowBox[{"VInvApply", "[", 
         RowBox[{"V", ",", "X"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Vinvy", "=", 
        RowBox[{"VInvApply", "[", 
         RowBox[{"V", ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"VinvX", ",", "Vinvy"}], "}"}], ",", "Indeterminate", ",",
            "Infinity"}], "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
           "Indeterminate", ",", "Indeterminate", ",", "Indeterminate", ",", 
            "Indeterminate"}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"betaHat", "=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "X", "]"}], ".", "VinvX"}], "//", 
           "SPD"}], ",", 
          RowBox[{
           RowBox[{"Transpose", "[", "X", "]"}], ".", "Vinvy"}], ",", 
          RowBox[{"Method", "->", "\"\<Cholesky\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"y", "-", 
         RowBox[{"X", ".", "betaHat"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"quad", "=", 
        RowBox[{"r", ".", 
         RowBox[{"VInvApply", "[", 
          RowBox[{"V", ",", "r"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"betaHat", ",", "r", ",", "quad", ",", "VinvX"}], "}"}]}]}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.969817664409214*^9, 3.9698177487505827`*^9}, {
   3.969818135999197*^9, 3.9698182622752037`*^9}, {3.96981829388805*^9, 
   3.969818385912059*^9}, 3.9698194687026787`*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"48f425cf-7d1a-4b7b-9f58-0605b1a415df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"2", ")"}], " ", "ML", " ", "and", " ", "REML", " ", "profiled", 
     " ", "log"}], "-", "likelihoods"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ML", ":", 
     RowBox[{"\[ScriptL]", 
      RowBox[{"(", "\[Theta]", ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"2", "[", 
       RowBox[{"log", "|", "V", "|", 
        RowBox[{
         RowBox[{
          RowBox[{"+", 
           RowBox[{"r", "'"}]}], 
          RowBox[{"V", "^", 
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}]}], "r"}], "+", 
         RowBox[{"n", " ", "log", 
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}]}]}]}], "]"}]}], " ", "with", " ", 
     "\[Beta]\:0302", " ", "profiled", " ", "out"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"logLikML", "[", 
      RowBox[{
       RowBox[{"tau2_", "?", "NumericQ"}], ",", 
       RowBox[{"sig2_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "V", ",", "betaHat", ",", "r", ",", "quad", ",", "ldV", ",", "val"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tau2", "<=", "0"}], "||", 
           RowBox[{"sig2", "<=", "0"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"-", "Infinity"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{"makeV", "[", 
          RowBox[{"tau2", ",", "sig2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"ldV", "=", 
         RowBox[{"logDetSPD", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"betaHat", ",", "r", ",", "quad"}], "}"}], "=", 
         RowBox[{
          RowBox[{"glsFromV", "[", "V", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "[", 
           RowBox[{
            RowBox[{"ldV", "===", 
             RowBox[{"-", "Infinity"}]}], ",", 
            RowBox[{"quad", "===", "Indeterminate"}]}], "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"-", "Infinity"}], "]"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"val", "=", 
         RowBox[{
          RowBox[{"-", "0.5"}], " ", 
          RowBox[{"(", 
           RowBox[{"ldV", "+", "quad", "+", 
            RowBox[{"n", " ", 
             RowBox[{"Log", "[", 
              RowBox[{"2.", " ", "Pi"}], "]"}]}]}], ")"}]}]}], ";", "\n", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "[", "val", "]"}], ",", "val", ",", 
          RowBox[{"-", "Infinity"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"REML", ":", 
      RowBox[{"\[ScriptL]_R", 
       RowBox[{"(", "\[Theta]", ")"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"2", "[", 
       RowBox[{"log", "|", "V", "|", 
        RowBox[{"+", "log"}], "|", 
        RowBox[{
         RowBox[{"X", "'"}], 
         RowBox[{"V", "^", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "X"}], "|", 
        RowBox[{
         RowBox[{
          RowBox[{"+", 
           RowBox[{"r", "'"}]}], 
          RowBox[{"V", "^", 
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}]}], "r"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "p"}], ")"}], " ", "log", 
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}]}]}]}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logLikREML", "[", 
      RowBox[{
       RowBox[{"tau2_", "?", "NumericQ"}], ",", 
       RowBox[{"sigma2_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "V", ",", "betaHat", ",", "r", ",", "quad", ",", "VinvX", ",", "ldV", 
         ",", "XtVinvX", ",", "ldXtVinvX", ",", "p", ",", "val"}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tau2", "<=", "0"}], "||", 
           RowBox[{"sigma2", "<=", "0"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"-", "Infinity"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{"makeV", "[", 
          RowBox[{"tau2", ",", "sigma2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ldV", "=", 
         RowBox[{"logDetSPD", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"betaHat", ",", "r", ",", "quad", ",", "VinvX"}], "}"}], "=", 
         RowBox[{"glsFromV", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "[", 
           RowBox[{
            RowBox[{"ldV", "===", 
             RowBox[{"-", "Infinity"}]}], ",", 
            RowBox[{"quad", "===", "Indeterminate"}], ",", 
            RowBox[{"VinvX", "===", "Indeterminate"}]}], "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"-", "Infinity"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"XtVinvX", "=", 
         RowBox[{"SPD", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Transpose", "[", "X", "]"}], ".", "VinvX"}], ")"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"ldXtVinvX", "=", 
         RowBox[{"logDetSPD", "[", "XtVinvX", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{
          RowBox[{"Dimensions", "[", "X", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"val", "=", 
         RowBox[{
          RowBox[{"-", "0.5"}], " ", 
          RowBox[{"(", 
           RowBox[{"ldV", "+", "ldXtVinvX", "+", "quad", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "p"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              RowBox[{"2.", " ", "Pi"}], "]"}]}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "[", "val", "]"}], ",", "val", ",", 
          RowBox[{"-", "Infinity"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Unconstrained", " ", "versions", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"optimize", " ", "on", " ", "log"}], "-", 
       RowBox[{"scale", " ", "for", " ", "robustness"}]}], ")"}]}], "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"logLikMLu", "[", 
      RowBox[{
       RowBox[{"ltau_", "?", "NumericQ"}], ",", 
       RowBox[{"lsigma_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"logLikML", "[", 
      RowBox[{
       RowBox[{"Exp", "[", "ltau", "]"}], ",", 
       RowBox[{"Exp", "[", "lsigma", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logLikREMLu", "[", 
      RowBox[{
       RowBox[{"ltau_", "?", "NumericQ"}], ",", 
       RowBox[{"lsigma_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"logLikREML", "[", 
      RowBox[{
       RowBox[{"Exp", "[", "ltau", "]"}], ",", 
       RowBox[{"Exp", "[", "lsigma", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.969818405548895*^9, 3.9698186010282717`*^9}, {
   3.969818638034831*^9, 3.969818648024527*^9}, {3.969819517631229*^9, 
   3.96981951809079*^9}, {3.9698195503495913`*^9, 3.969819606788102*^9}, 
   3.969874456789323*^9, {3.9698745342750874`*^9, 3.969874534900482*^9}, {
   3.969874585278322*^9, 3.969874618116108*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"f43b4ff5-ae91-4f00-b235-6dae6f6658e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"3", ")"}], " ", "Optimize", " ", "ML", " ", "and", " ", "REML"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "ML", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Use", " ", "FindMaximum", " ", "on", " ", "the", " ", "unconstrained", " ", 
    RowBox[{"(", 
     RowBox[{"log", "-", "scale"}], ")"}], " ", "objectives"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"solML", "=", 
     RowBox[{"FindMaximum", "[", 
      RowBox[{
       RowBox[{"logLikMLu", "[", 
        RowBox[{"ltau", ",", "lsigma"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ltau", ",", 
           RowBox[{"Log", "[", "0.5", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"lsigma", ",", 
           RowBox[{"Log", "[", "0.5", "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<QuasiNewton\>\""}], ",", 
       RowBox[{"AccuracyGoal", "->", "8"}], ",", 
       RowBox[{"PrecisionGoal", "->", "8"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"tau2HatML", "=", 
     RowBox[{"Exp", "[", 
      RowBox[{"ltau", "/.", " ", 
       RowBox[{"Last", "@", "solML"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"sigma2HatML", "=", 
     RowBox[{"Exp", "[", 
      RowBox[{"lsigma", "/.", " ", 
       RowBox[{"Last", "@", "solML"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9698186649936666`*^9, 3.9698186778933992`*^9}, {
   3.969818713985257*^9, 3.969818790220625*^9}, {3.969818862414956*^9, 
   3.969818968026387*^9}, 3.969819637481468*^9},
 CellLabel->
  "In[118]:=",ExpressionUUID->"0abed561-0e2b-4bb6-a88b-cee8a8a9ecc9"],

Cell[CellGroupData[{

Cell[BoxData["solML"], "Input",
 CellChangeTimes->{{3.969819729523563*^9, 3.969819730281312*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"e2a3c440-307d-404b-83ec-bab1c6e3c4f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "9.829864236445264`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ltau", "\[Rule]", 
      RowBox[{"-", "18.916509620576463`"}]}], ",", 
     RowBox[{"lsigma", "\[Rule]", 
      RowBox[{"-", "0.8719042319509286`"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.969819730947495*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"56af9f51-58a2-4046-9633-4adc2913fd99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"makeV", "[", 
   RowBox[{"tau2HatML", ",", "sigma2HatML"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.969820160406108*^9, 3.9698201793217297`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"7c3aeba5-1127-4a66-a1c1-bc2f6e1f229e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.41815453351038434`", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"6.0906585756139695`*^-9", "0.41815453351038434`", 
      "6.0906585756139695`*^-9", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"6.0906585756139695`*^-9", "6.0906585756139695`*^-9", 
      "0.41815453351038434`", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"6.0906585756139695`*^-9", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "0.41815453351038434`", 
      "6.0906585756139695`*^-9", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"6.0906585756139695`*^-9", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "6.0906585756139695`*^-9", 
      "0.41815453351038434`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.41815453351038434`", 
      "6.0906585756139695`*^-9", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "6.0906585756139695`*^-9"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "6.0906585756139695`*^-9", 
      "0.41815453351038434`", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "6.0906585756139695`*^-9"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "0.41815453351038434`", 
      "6.0906585756139695`*^-9", "6.0906585756139695`*^-9"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "6.0906585756139695`*^-9", 
      "0.41815453351038434`", "6.0906585756139695`*^-9"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "6.0906585756139695`*^-9", 
      "6.0906585756139695`*^-9", "0.41815453351038434`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.969820169178886*^9, 3.969820179893063*^9}},
 CellLabel->
  "Out[132]//MatrixForm=",ExpressionUUID->"fa348085-24fc-43ea-bb71-\
3b121fa79a2e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"VML", "=", 
   RowBox[{"makeV", "[", 
    RowBox[{"tau2HatML", ",", "sigma2HatML"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.969820280106028*^9, 3.9698203164207582`*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"1db4e79f-1e44-4825-94d8-24b1ae4b1648"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"betaHatML", ",", "rML"}], "}"}], "=", 
   RowBox[{
    RowBox[{"glsFromV", "[", "VML", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{";;", "2"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.969820332967214*^9, 3.9698203564066143`*^9}, {
  3.969820403772931*^9, 3.969820440148581*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"64760c82-42c6-4b77-994c-c27bb8ffe1d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bHatML", "=", 
  RowBox[{"tau2HatML", "*", 
   RowBox[{
    RowBox[{"Transpose", "[", "Z", "]"}], ".", 
    RowBox[{"VInvApply", "[", 
     RowBox[{"VML", ",", "rML"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.969820444353294*^9, 3.969820489800871*^9}, {
  3.969820749638279*^9, 3.969820761743956*^9}, {3.96982108254191*^9, 
  3.969821084161639*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"155a9700-94f0-467f-a1c9-1d6a221bbb73"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.029059661648615`*^-8"}], ",", "2.0290596616486044`*^-8"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.969820763273609*^9, 3.969821084759325*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"d85e70c6-6084-40f5-9f64-dc2e10c9c5f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["betaHatML"], "Input",
 CellChangeTimes->{{3.9698206891812973`*^9, 3.969820691355401*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"85be527f-357f-475b-b1ca-6a6a4e070d86"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.8862357057693597`", ",", "0.7276294230640837`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.969820693134029*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"77c1a20a-8d63-4125-ae34-a3190f757eea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["tau2HatML"], "Input",
 CellChangeTimes->{{3.969820838387734*^9, 3.96982084072057*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"252c26e9-dc82-4979-a637-fd45d39d9354"],

Cell[BoxData["6.0906585756139695`*^-9"], "Output",
 CellChangeTimes->{3.969820842626315*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"63185b31-24b0-47b7-bcfa-76ea1ce41e1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["sigma2HatML"], "Input",
 CellLabel->
  "In[153]:=",ExpressionUUID->"5817329c-2cc9-4063-9af9-7d6fc46ca05f"],

Cell[BoxData["0.41815452741972575`"], "Output",
 CellChangeTimes->{3.969820868597074*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"f22bd002-ea30-472c-9905-6b0950fc6414"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "REML", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Use", " ", "FindMaximum", " ", "on", " ", "the", " ", "unconstrained", " ", 
    RowBox[{"(", 
     RowBox[{"log", "-", "scale"}], ")"}], " ", "objectives"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solREML", "=", 
    RowBox[{"FindMaximum", "[", 
     RowBox[{
      RowBox[{"logLikREMLu", "[", 
       RowBox[{"ltau", ",", "lsigma"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ltau", ",", 
          RowBox[{"Log", "[", "0.5", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"lsigma", ",", 
          RowBox[{"Log", "[", "0.5", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<QuasiNewton\>\""}], ",", 
      RowBox[{"AccuracyGoal", "->", "6"}], ",", 
      RowBox[{"PrecisionGoal", "->", "6"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.9698746696390543`*^9, 3.9698746905271482`*^9}, {
  3.969874746462747*^9, 3.969874750382469*^9}, {3.969874872651178*^9, 
  3.969874892240943*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"abb271a8-3d96-44b5-b1c2-1e623e0409f0"],

Cell[CellGroupData[{

Cell[BoxData["solREML"], "Input",
 CellChangeTimes->{{3.9698747178580103`*^9, 3.969874719763658*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"83bd190d-ec65-4409-925e-b0f298f88729"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "11.063796494702697`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ltau", "\[Rule]", 
      RowBox[{"-", "2.6329241164131423`"}]}], ",", 
     RowBox[{"lsigma", "\[Rule]", 
      RowBox[{"-", "0.7335825957195949`"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9698747208333597`*^9, 3.969874756507083*^9, 
  3.9698748344169188`*^9, 3.9698748989247103`*^9},
 CellLabel->
  "Out[169]=",ExpressionUUID->"184571a8-ff3b-4901-bb5a-2e087c400079"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tau2HatREML", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{"ltau", "/.", " ", 
     RowBox[{"Last", "@", "solREML"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sigma2HatREML", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{"lsigma", "/.", " ", 
     RowBox[{"Last", "@", "solREML"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.969874788383607*^9, 3.969874788383626*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"7a588e82-e71c-4baa-8948-192b9b35bbb8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"makeV", "[", 
   RowBox[{"tau2HatREML", ",", "sigma2HatREML"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.96987515516029*^9, 3.969875159217492*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"53f77877-01b4-43ee-b1a7-a4931a00806e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5520535982402278`", "0.07186800427605047`", "0.07186800427605047`", 
      "0.07186800427605047`", "0.07186800427605047`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.07186800427605047`", "0.5520535982402278`", "0.07186800427605047`", 
      "0.07186800427605047`", "0.07186800427605047`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.07186800427605047`", "0.07186800427605047`", "0.5520535982402278`", 
      "0.07186800427605047`", "0.07186800427605047`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.07186800427605047`", "0.07186800427605047`", "0.07186800427605047`", 
      "0.5520535982402278`", "0.07186800427605047`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.07186800427605047`", "0.07186800427605047`", "0.07186800427605047`", 
      "0.07186800427605047`", "0.5520535982402278`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.5520535982402278`", 
      "0.07186800427605047`", "0.07186800427605047`", "0.07186800427605047`", 
      "0.07186800427605047`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.07186800427605047`", 
      "0.5520535982402278`", "0.07186800427605047`", "0.07186800427605047`", 
      "0.07186800427605047`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.07186800427605047`", 
      "0.07186800427605047`", "0.5520535982402278`", "0.07186800427605047`", 
      "0.07186800427605047`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.07186800427605047`", 
      "0.07186800427605047`", "0.07186800427605047`", "0.5520535982402278`", 
      "0.07186800427605047`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.07186800427605047`", 
      "0.07186800427605047`", "0.07186800427605047`", "0.07186800427605047`", 
      "0.5520535982402278`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9698751617084723`*^9},
 CellLabel->
  "Out[176]//MatrixForm=",ExpressionUUID->"bdee54ec-0445-46ac-a5c6-\
3c320d1d3dd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"VREML", "=", 
   RowBox[{"makeV", "[", 
    RowBox[{"tau2HatREML", ",", "sigma2HatREML"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"betaHatREML", ",", "rREML"}], "}"}], "=", 
   RowBox[{
    RowBox[{"glsFromV", "[", "VREML", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{";;", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bHatREML", "=", 
  RowBox[{"tau2HatREML", "*", 
   RowBox[{
    RowBox[{"Transpose", "[", "Z", "]"}], ".", 
    RowBox[{"VInvApply", "[", 
     RowBox[{"VREML", ",", "rREML"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.969875212059774*^9, 3.9698753366518717`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"ce92b960-1f19-4bfb-85ce-3372cd623675"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.12205591370391161`"}], ",", "0.12205591370391197`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9698752737419147`*^9, 3.969875287815474*^9}, {
  3.969875328987525*^9, 3.9698753388990307`*^9}},
 CellLabel->
  "Out[189]=",ExpressionUUID->"3a52f5e8-1773-4fbc-8697-747871ad7e6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["betaHatREML"], "Input",
 CellChangeTimes->{{3.9698753809190397`*^9, 3.969875383600007*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"37b5f4a4-5f02-4263-9d2b-f2248262d7c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.8864976507719626`", ",", "0.7014349228036931`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.96987538417544*^9},
 CellLabel->
  "Out[190]=",ExpressionUUID->"93a591b3-5e40-4ecf-a2ce-20b31634a214"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["tau2HatREML"], "Input",
 CellChangeTimes->{{3.969875397850801*^9, 3.9698754322056513`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"f17421e4-ce7c-46ae-974d-501c8d7f9359"],

Cell[BoxData["0.07186800427605047`"], "Output",
 CellChangeTimes->{{3.9698754068346663`*^9, 3.969875436610299*^9}},
 CellLabel->
  "Out[192]=",ExpressionUUID->"b9c98edb-437f-4f5b-9210-7f7fdaa6362a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["sigma2HatREML"], "Input",
 CellChangeTimes->{{3.969875477638465*^9, 3.9698754778001966`*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"a69b84d0-95f1-48d5-bb79-a12917ea9f29"],

Cell[BoxData["0.4801855939641773`"], "Output",
 CellChangeTimes->{3.969875480567305*^9},
 CellLabel->
  "Out[193]=",ExpressionUUID->"cb52c8f8-5284-48e5-a7c3-bdd86289fe7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kML", "=", 
  RowBox[{"sigma2HatML", "/", "tau2HatML"}]}], "\[IndentingNewLine]", 
 RowBox[{"kREML", "=", 
  RowBox[{"sigma2HatREML", "/", "tau2HatREML"}]}]}], "Input",
 CellChangeTimes->{{3.969875670701338*^9, 3.969875721417459*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"2d9c4666-6550-4453-9165-3553b209910e"],

Cell[BoxData["6.865505958484524`*^7"], "Output",
 CellChangeTimes->{3.969875690265526*^9, 3.969875722633175*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"b6e59d95-c20f-4a02-b97d-4b6b216934a3"],

Cell[BoxData["6.681493368310992`"], "Output",
 CellChangeTimes->{3.969875690265526*^9, 3.9698757226348333`*^9},
 CellLabel->
  "Out[196]=",ExpressionUUID->"3bb1e08f-49eb-4cc9-bbdc-807bbdc5ecc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ICCML", "=", 
  RowBox[{"tau2HatML", "/", 
   RowBox[{"(", 
    RowBox[{"tau2HatML", "+", "sigma2HatML"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.969875745071023*^9, 3.9698757584942827`*^9}, {
  3.969875872816835*^9, 3.969875884929192*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"c4ba073a-ea22-4344-9e39-94e3dad8ee45"],

Cell[BoxData["1.4565568677405516`*^-8"], "Output",
 CellChangeTimes->{3.969875759220078*^9, 3.969875886402337*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"1c75c8e9-c29b-4605-b575-1b9d5c462440"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ICCREML", "=", 
  RowBox[{"tau2HatREML", "/", 
   RowBox[{"(", 
    RowBox[{"tau2HatREML", "+", "sigma2HatREML"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.9698757660776587`*^9, 3.969875775028344*^9}, {
  3.969875891220194*^9, 3.96987590125033*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"b12045ce-2c49-4dab-85aa-d99c474fa40e"],

Cell[BoxData["0.13018301937555143`"], "Output",
 CellChangeTimes->{3.9698757758117943`*^9, 3.969875902274061*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"66c9a803-b0a6-48f9-953c-a024ab0d103d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"5", "/", 
  RowBox[{"(", 
   RowBox[{"5", "+", "kML"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.96987592465751*^9, 3.969875933204742*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"380d1a11-622d-4888-b134-ff63be01bf50"],

Cell[BoxData["7.282783914391202`*^-8"], "Output",
 CellChangeTimes->{3.9698759350019197`*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"524de4a7-754d-4c27-92ce-88c4906a7d76"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"5", "/", 
  RowBox[{"(", 
   RowBox[{"5", "+", "kREML"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.969875943155058*^9, 3.969875950141968*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"851ca52d-35c5-489f-b485-e582cf4d3ea3"],

Cell[BoxData["0.42802746552626275`"], "Output",
 CellChangeTimes->{3.9698759511215754`*^9},
 CellLabel->
  "Out[202]=",ExpressionUUID->"3a5a47a6-1fc1-4a0c-bdd1-47e99dcec50b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Random Intercept & Slope", "Section",
 CellChangeTimes->{{3.969884160353065*^9, 
  3.969884167677536*^9}},ExpressionUUID->"b8ed7642-33cb-48df-8fe1-\
73bc424cd27d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "[", "y", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groups", "=", 
   RowBox[{"Union", "[", "g", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ng", "=", 
   RowBox[{"Length", "[", "groups", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gIndex", "=", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{"groups", "->", 
     RowBox[{"Range", "[", "ng", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.969884174582955*^9, 3.969884245659217*^9}, {
  3.9698848712595387`*^9, 3.969884892637743*^9}, {3.969884991271677*^9, 
  3.969884991483635*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"c7735443-6624-4f6b-97d8-2f2a42f7d1ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colInt", "=", 
   RowBox[{
    RowBox[{"2", " ", "g"}], "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colSlope", "=", 
   RowBox[{"colInt", "+", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9698849087808037`*^9, 3.969884961080803*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"d8dd4c17-c732-429d-877e-28d098eeeb7a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"X", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.969884252814247*^9, {3.969884455161182*^9, 3.969884457134893*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"c7ba10a5-6b5c-4008-b363-963074d4d23b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", 
      RowBox[{"-", "1.7`"}]},
     {"1.`", 
      RowBox[{"-", "0.8`"}]},
     {"1.`", 
      RowBox[{"-", "0.2`"}]},
     {"1.`", "0.`"},
     {"1.`", "1.5`"},
     {"1.`", 
      RowBox[{"-", "1.2`"}]},
     {"1.`", 
      RowBox[{"-", "0.5`"}]},
     {"1.`", "0.3`"},
     {"1.`", "0.9`"},
     {"1.`", "1.8`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.969884253535215*^9, 3.96988445753859*^9},
 CellLabel->
  "Out[218]//MatrixForm=",ExpressionUUID->"e2ff3b85-6ec2-4bcf-82f6-\
caea43b97639"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Build", " ", "Z", " ", "as", " ", "a", " ", "sparse", " ", "matrix", " ",
       "from", " ", 
      RowBox[{"triplets", ":", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"row", " ", "i"}], ",", 
         RowBox[{"colInt", "[", "i", "]"}]}], ")"}]}]}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"row", " ", "i"}], ",", 
       RowBox[{"colSlope", "[", "i", "]"}]}], ")"}], "->", 
     RowBox[{"x", "[", "i", "]"}]}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"Z", "=", 
     RowBox[{"N", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"1.", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "0.", ",", "0."}], "}"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"group", " ", "1"}], ":", 
             RowBox[{
             "put", " ", "values", " ", "in", " ", "cols", " ", "1"}]}], "\[Dash]",
             "2"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "1.", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "    ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"group", " ", "2"}], ":", 
            RowBox[{
            "put", " ", "values", " ", "in", " ", "cols", " ", "3"}]}], "\[Dash]",
            "4"}], "*)"}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Z", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.969884497522822*^9, 3.969884704997867*^9}, {
  3.969885012070692*^9, 3.9698850188491096`*^9}, {3.969885273010858*^9, 
  3.969885324971199*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"2f22e0f5-db8a-4957-b4d0-10ce0335913b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", 
      RowBox[{"-", "1.7`"}], "0.`", "0.`"},
     {"1.`", 
      RowBox[{"-", "0.8`"}], "0.`", "0.`"},
     {"1.`", 
      RowBox[{"-", "0.2`"}], "0.`", "0.`"},
     {"1.`", "0.`", "0.`", "0.`"},
     {"1.`", "1.5`", "0.`", "0.`"},
     {"0.`", "0.`", "1.`", 
      RowBox[{"-", "1.2`"}]},
     {"0.`", "0.`", "1.`", 
      RowBox[{"-", "0.5`"}]},
     {"0.`", "0.`", "1.`", "0.3`"},
     {"0.`", "0.`", "1.`", "0.9`"},
     {"0.`", "0.`", "1.`", "1.8`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.969885021375943*^9, 3.969885279006345*^9, 
  3.969885325723634*^9},
 CellLabel->
  "Out[253]//MatrixForm=",ExpressionUUID->"15df08e6-30b0-4697-86d0-\
ace7e25d952c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "Z", "]"}]], "Input",
 CellChangeTimes->{{3.969885344634673*^9, 3.96988535016465*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"4f4829b8-1ce8-4956-9b3c-ecca13553d83"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.969885350671316*^9},
 CellLabel->
  "Out[254]=",ExpressionUUID->"d7ae9527-5e3a-4027-ba2c-2640b4beb7c5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Group", "-", 
     RowBox[{"level", " ", "covariance", " ", "D"}]}], "=", 
    RowBox[{"I_N", "\[CircleTimes]", "D2"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Parameterize", " ", "D2", " ", "via", " ", "SDs"}], "+", 
    RowBox[{"correlation", " ", 
     RowBox[{"(", 
      RowBox[{"PSD", " ", "guaranteed"}], ")"}]}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "D2", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"D2", "[", 
      RowBox[{"\[Tau]0_", ",", "\[Tau]1_", ",", "\[Rho]_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Tau]0", "^", "2"}], ",", 
         RowBox[{"\[Rho]", " ", "\[Tau]0", " ", "\[Tau]1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Rho]", " ", "\[Tau]0", " ", "\[Tau]1"}], ",", 
         RowBox[{"\[Tau]1", "^", "2"}]}], "}"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.96988540270037*^9, 3.969885559198049*^9}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"c7cd0ffd-97cf-4861-a0d7-8c0b63be08d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]0", "=", "0.8"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"SD", " ", "of", " ", "random", " ", "intercept"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]1", "=", "0.5"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"SD", " ", "of", " ", "random", " ", "slope"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "=", "0.3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Correlation", " ", "between", " ", "random", " ", "intercept", " ", "and",
     " ", "slope"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.969885565724669*^9, 3.9698856345607157`*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"a32c1309-1646-4f03-88c7-6acfc632da43"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IdentityMatrix", "[", "ng", "]"}]], "Input",
 CellChangeTimes->{{3.9698856425101757`*^9, 3.9698856605552597`*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"195ad528-d4c0-4ece-946d-92766095ce5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.969885661504588*^9},
 CellLabel->
  "Out[261]=",ExpressionUUID->"6ed06660-4f1c-43a0-a3e8-6df5feff6815"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D2", "[", 
  RowBox[{"\[Tau]0", ",", "\[Tau]1", ",", "\[Rho]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9698856795768623`*^9, 3.969885693349575*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"e75be986-d961-41bc-802c-d68e3d82e26d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.6400000000000001`", ",", "0.12`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.12`", ",", "0.25`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.969885694603558*^9},
 CellLabel->
  "Out[262]=",ExpressionUUID->"9867acc7-eb83-4176-88aa-ae6dee41d77b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dk", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "ng", "]"}], ",", 
     RowBox[{"D2", "[", 
      RowBox[{"\[Tau]0", ",", "\[Tau]1", ",", "\[Rho]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dk", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.969885712430668*^9, 3.969885770967585*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"cc2e8b0d-e871-45f9-99f9-fbefce7506f8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.6400000000000001`", "0.12`", "0.`", "0.`"},
     {"0.12`", "0.25`", "0.`", "0.`"},
     {"0.`", "0.`", "0.6400000000000001`", "0.12`"},
     {"0.`", "0.`", "0.12`", "0.25`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.969885735373866*^9, 3.9698857720496817`*^9}},
 CellLabel->
  "Out[267]//MatrixForm=",ExpressionUUID->"2facc855-52ad-44a9-9a08-\
201b9e4c781f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimensions", "[", "Dk", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", " ", "ng"}], ",", 
      RowBox[{"2", " ", "ng"}]}], "}"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.96988579934459*^9, 3.969885818110278*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"bd0c0a1a-fa82-4579-adb1-7734d65bd1cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.9698858046016827`*^9, 3.9698858191150227`*^9}},
 CellLabel->
  "Out[269]=",ExpressionUUID->"9cd48ce4-8f1e-4f52-b39f-900062911e8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Marginal", " ", "covariance", " ", "of", " ", "y", " ", "under", " ", 
      "RI"}], "+", 
     RowBox[{"RS", ":", "V"}]}], "=", 
    RowBox[{
     RowBox[{"Z", " ", "D", " ", 
      RowBox[{"Z", "'"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "^", "2"}], " ", "I"}]}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{
      RowBox[{"Z", ".", "Dk", ".", 
       RowBox[{"Transpose", "[", "Z", "]"}]}], "+", 
      RowBox[{"sig2", " ", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"V", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.969885829293458*^9, 3.969885875690781*^9}, {
  3.969885906189721*^9, 3.969885951564842*^9}, {3.969886568054907*^9, 
  3.9698865776205387`*^9}, {3.969886657486199*^9, 3.969886666446443*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"6f0f733e-a4ad-4737-bf28-c9b2c2b5996a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.3145000000000002`", "0.6800000000000002`", "0.4970000000000001`", 
      "0.4360000000000001`", 
      RowBox[{"-", "0.02149999999999988`"}], "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.6800000000000002`", "0.9680000000000002`", "0.5600000000000002`", 
      "0.5440000000000002`", "0.42400000000000015`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.4970000000000001`", "0.56`", "0.9620000000000001`", 
      "0.6160000000000001`", "0.7210000000000001`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.4360000000000001`", "0.5440000000000002`", "0.6160000000000001`", 
      "1.`", "0.8200000000000001`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {
      RowBox[{"-", "0.021499999999999908`"}], "0.42400000000000004`", 
      "0.7210000000000001`", "0.8200000000000001`", "1.9224999999999999`", 
      "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "1.072`", "0.5860000000000001`", 
      "0.4420000000000001`", "0.33400000000000013`", "0.17200000000000013`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.5860000000000001`", "0.9425`", 
      "0.5785000000000001`", "0.5755`", "0.5710000000000001`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.44200000000000017`", 
      "0.5785000000000001`", "1.0945`", "0.8515000000000001`", 
      "1.0270000000000001`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.33400000000000013`", 
      "0.5755000000000001`", "0.8515000000000001`", "1.4184999999999999`", 
      "1.369`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.17200000000000004`", 
      "0.5710000000000001`", "1.0270000000000001`", "1.3690000000000002`", 
      "2.2420000000000004`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.969885906842125*^9, 3.9698859519704447`*^9}, 
   3.9698865809171543`*^9, 3.969886666914394*^9},
 CellLabel->
  "Out[284]//MatrixForm=",ExpressionUUID->"6f1c3d5e-ca45-40aa-b496-\
52dd746465bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Sanity", ":", 
    RowBox[{
    "V", " ", "must", " ", "be", " ", "symmetric", " ", "PSD", " ", "quick", " ",
      "checks"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CholeskyDecomposition", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"V", "+", 
        RowBox[{"Transpose", "[", "V", "]"}]}], ")"}], "/", "2"}], "]"}], 
    ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"throws", " ", "if", " ", "not", " ", "SPD"}], "*)"}], "\n", 
   RowBox[{"Dimensions", "[", "V", "]"}], 
   RowBox[{"(*", " ", 
    RowBox[{"->", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.969886682454075*^9, 3.969886718006382*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"f9c4d9ed-b2f8-4235-9f20-355ad6f1a034"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{{3.969886699366523*^9, 3.969886719670165*^9}},
 CellLabel->
  "Out[288]=",ExpressionUUID->"fef1f941-32d8-4ede-a029-0bee478bec5f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Verify", " ", "against", " ", "closed"}], "-", 
    RowBox[{
    "form", " ", "covariance", " ", "within", " ", "a", " ", "group"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"For", " ", "i", " ", 
     RowBox[{"(", "group", ")"}]}], ",", 
    RowBox[{
     RowBox[{"j", "!=", 
      RowBox[{"k", ":", 
       RowBox[{"Cov", 
        RowBox[{"(", 
         RowBox[{"Y_ij", ",", "Y_ik"}], ")"}]}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Tau]0", "^", "2"}], "+", 
       RowBox[{"\[Tau]01", 
        RowBox[{"(", 
         RowBox[{"x_ij", "+", "x_ik"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"\[Tau]1", "^", "2"}], " ", "x_ij", " ", "x_ik", " ", "with", 
        " ", "\[Tau]01"}]}], "=", 
      RowBox[{"\[Rho]", " ", "\[Tau]0", " ", "\[Tau]1"}]}]}], ",", 
    RowBox[{"and", " ", "Var", 
     RowBox[{"(", "Y_ij", ")"}], " ", "adds", " ", 
     RowBox[{"\[Sigma]", "^", "2"}], " ", "on", " ", "the", " ", 
     RowBox[{"diagonal", "."}]}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Tau]01", "=", 
     RowBox[{"\[Rho]", " ", "\[Tau]0", " ", "\[Tau]1"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"covFormula", "[", 
      RowBox[{"xj_", ",", "xk_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Tau]0", "^", "2"}], "+", 
      RowBox[{"\[Tau]01", " ", 
       RowBox[{"(", 
        RowBox[{"xj", "+", "xk"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"\[Tau]1", "^", "2"}], " ", "xj", " ", "xk"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"varFormula", "[", "xj_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Tau]0", "^", "2"}], "+", 
      RowBox[{"2", " ", "\[Tau]01", " ", "xj"}], "+", 
      RowBox[{
       RowBox[{"\[Tau]1", "^", "2"}], " ", 
       RowBox[{"xj", "^", "2"}]}], "+", "sig2"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.969886942661694*^9, 3.9698869793063183`*^9}, {
  3.969887184993656*^9, 3.969887189350698*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"b5593ffb-9079-4999-a6b9-da076028281f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gi", "=", 
   RowBox[{"First", "[", "groups", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"idx", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Position", "[", 
     RowBox[{"g", ",", "gi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", 
   RowBox[{"idx", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"idx", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.969887001535364*^9, 3.9698870606837587`*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"50763232-cb3b-48b0-adca-db1f59b47892"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Compare", " ", "matrix", " ", "V", " ", "entries", " ", "to", " ", 
    "formulas"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<V[j,k] (matrix)\>\"", "->", 
     RowBox[{"V", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "k"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Cov formula (j,k)\>\"", "->", 
     RowBox[{"N", "@", 
      RowBox[{"covFormula", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"x", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<V[j,j] (matrix diag)\>\"", "->", 
     RowBox[{"V", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "j"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Var formula (j)\>\"", "->", 
     RowBox[{"N", "@", 
      RowBox[{"varFormula", "[", 
       RowBox[{"x", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.969887066925891*^9, 3.96988706904989*^9}, {
   3.9698871328524647`*^9, 3.969887168198751*^9}, 3.9698872122441587`*^9},
 CellLabel->
  "In[321]:=",ExpressionUUID->"c23f0298-d646-44b0-9ef9-3794a952be2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"V[j,k] (matrix)\"\>", "\[Rule]", "0.6800000000000002`"}], ",", 
   RowBox[{"\<\"Cov formula (j,k)\"\>", "\[Rule]", "0.6800000000000002`"}], ",", 
   RowBox[{"\<\"V[j,j] (matrix diag)\"\>", "\[Rule]", "1.3145000000000002`"}],
    ",", 
   RowBox[{"\<\"Var formula (j)\"\>", "\[Rule]", "1.3145000000000002`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.9698870706063833`*^9, {3.969887144738927*^9, 3.9698872165606813`*^9}},
 CellLabel->
  "Out[321]=",ExpressionUUID->"c165388d-ba04-4f5b-af9f-0918d1a07f1d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{878.25, 909},
WindowMargins->{{Automatic, 72.75}, {42, Automatic}},
LightDark->"Light",
FrontEndVersion->"14.3 for Linux x86 (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"dc83b90f-0c41-49b4-a9b0-022e9ff6aa60"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 4082, 116, 391, "Input",ExpressionUUID->"ff03ce13-002c-4b75-8642-2a17c58b4488"],
Cell[CellGroupData[{
Cell[4661, 140, 254, 4, 29, "Input",ExpressionUUID->"99bb54d2-1ee1-41de-a2e5-fac835bcbda4"],
Cell[4918, 146, 967, 33, 194, "Output",ExpressionUUID->"4d4f9d77-d2ee-4e7b-ab10-47404cb3646e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5922, 184, 206, 3, 29, "Input",ExpressionUUID->"cddd545c-1cea-4429-8e45-fbdfb8e28fe0"],
Cell[6131, 189, 796, 27, 194, "Output",ExpressionUUID->"73f05810-21bd-4367-8169-d593d5f18f94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6964, 221, 385, 8, 29, "Input",ExpressionUUID->"0a639caa-7b65-4b45-9bc6-ba4d30cdb36f"],
Cell[7352, 231, 310, 7, 33, "Output",ExpressionUUID->"63b14d0d-a3fb-4c09-baca-131d3c1f8338"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7699, 243, 680, 14, 69, "Input",ExpressionUUID->"4d2a3f84-6f24-4987-ad1f-af311a64223c"],
Cell[8382, 259, 1537, 37, 194, "Output",ExpressionUUID->"0f88cbaa-18cb-49a7-9f08-e8dd3bfebf27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9956, 301, 548, 13, 69, "Input",ExpressionUUID->"080410b0-6f3b-46fc-838a-3e0c936201c0"],
Cell[10507, 316, 658, 19, 59, "Output",ExpressionUUID->"cd024944-bb7e-473b-934e-b007da6daf7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11202, 340, 501, 10, 29, "Input",ExpressionUUID->"38bbdf67-469f-455a-bc49-79bf7a0c9daf"],
Cell[11706, 352, 257, 5, 33, "Output",ExpressionUUID->"06c3e523-79be-4c9a-87b3-eb4d860fe758"]
}, Open  ]],
Cell[11978, 360, 1020, 25, 33, "Text",ExpressionUUID->"c8450167-f137-4284-a93b-d2b508871c78"],
Cell[CellGroupData[{
Cell[13023, 389, 499, 11, 49, "Input",ExpressionUUID->"e8903ba3-0ca3-49d8-893e-d51f85d8ecce"],
Cell[13525, 402, 1649, 39, 194, "Output",ExpressionUUID->"4cadd567-5f49-46e3-a912-1224da59b98b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15211, 446, 447, 10, 29, "Input",ExpressionUUID->"28f05bde-de1f-4028-9ee8-5bf3f2122288"],
Cell[15661, 458, 205, 3, 33, "Output",ExpressionUUID->"563c981d-6384-4fc4-b65b-26a4cd8125d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15903, 466, 231, 4, 29, "Input",ExpressionUUID->"e268e2fd-08cb-419d-9bce-942a20bafa03"],
Cell[16137, 472, 206, 3, 33, "Output",ExpressionUUID->"d729ed15-40cd-4c29-ae4b-8a004874be11"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16380, 480, 205, 4, 65, "Section",ExpressionUUID->"47ec6724-1f53-4631-bc01-3a551bfbf0af"],
Cell[16588, 486, 431, 10, 49, "Input",ExpressionUUID->"092ccbc9-de54-42f7-a88a-7978f0bd23cd"],
Cell[17022, 498, 6412, 186, 422, "Input",ExpressionUUID->"55e0e461-d078-4105-a82f-261fde17068f"],
Cell[23437, 686, 5313, 157, 269, "Input",ExpressionUUID->"48f425cf-7d1a-4b7b-9f58-0605b1a415df"],
Cell[28753, 845, 8410, 227, 652, "Input",ExpressionUUID->"f43b4ff5-ae91-4f00-b235-6dae6f6658e7"],
Cell[37166, 1074, 2145, 55, 213, "Input",ExpressionUUID->"0abed561-0e2b-4bb6-a88b-cee8a8a9ecc9"],
Cell[CellGroupData[{
Cell[39336, 1133, 180, 3, 29, "Input",ExpressionUUID->"e2a3c440-307d-404b-83ec-bab1c6e3c4f6"],
Cell[39519, 1138, 435, 12, 33, "Output",ExpressionUUID->"56af9f51-58a2-4046-9633-4adc2913fd99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39991, 1155, 287, 7, 29, "Input",ExpressionUUID->"7c3aeba5-1127-4a66-a1c1-bc2f6e1f229e"],
Cell[40281, 1164, 2491, 47, 212, "Output",ExpressionUUID->"fa348085-24fc-43ea-bb71-3b121fa79a2e"]
}, Open  ]],
Cell[42787, 1214, 296, 7, 29, "Input",ExpressionUUID->"1db4e79f-1e44-4825-94d8-24b1ae4b1648"],
Cell[43086, 1223, 441, 12, 29, "Input",ExpressionUUID->"64760c82-42c6-4b77-994c-c27bb8ffe1d4"],
Cell[CellGroupData[{
Cell[43552, 1239, 461, 11, 29, "Input",ExpressionUUID->"155a9700-94f0-467f-a1c9-1d6a221bbb73"],
Cell[44016, 1252, 285, 7, 34, "Output",ExpressionUUID->"d85e70c6-6084-40f5-9f64-dc2e10c9c5f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44338, 1264, 186, 3, 29, "Input",ExpressionUUID->"85be527f-357f-475b-b1ca-6a6a4e070d86"],
Cell[44527, 1269, 237, 6, 33, "Output",ExpressionUUID->"77c1a20a-8d63-4125-ae34-a3190f757eea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44801, 1280, 183, 3, 29, "Input",ExpressionUUID->"252c26e9-dc82-4979-a637-fd45d39d9354"],
Cell[44987, 1285, 175, 3, 33, "Output",ExpressionUUID->"63185b31-24b0-47b7-bcfa-76ea1ce41e1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45199, 1293, 120, 2, 29, "Input",ExpressionUUID->"5817329c-2cc9-4063-9af9-7d6fc46ca05f"],
Cell[45322, 1297, 172, 3, 33, "Output",ExpressionUUID->"f22bd002-ea30-472c-9905-6b0950fc6414"]
}, Open  ]],
Cell[45509, 1303, 1186, 30, 89, "Input",ExpressionUUID->"abb271a8-3d96-44b5-b1c2-1e623e0409f0"],
Cell[CellGroupData[{
Cell[46720, 1337, 184, 3, 29, "Input",ExpressionUUID->"83bd190d-ec65-4409-925e-b0f298f88729"],
Cell[46907, 1342, 511, 13, 33, "Output",ExpressionUUID->"184571a8-ff3b-4901-bb5a-2e087c400079"]
}, Open  ]],
Cell[47433, 1358, 493, 13, 53, "Input",ExpressionUUID->"7a588e82-e71c-4baa-8948-192b9b35bbb8"],
Cell[CellGroupData[{
Cell[47951, 1375, 288, 7, 29, "Input",ExpressionUUID->"53f77877-01b4-43ee-b1a7-a4931a00806e"],
Cell[48242, 1384, 2339, 47, 194, "Output",ExpressionUUID->"bdee54ec-0445-46ac-a5c6-3c320d1d3dd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50618, 1436, 776, 21, 69, "Input",ExpressionUUID->"ce92b960-1f19-4bfb-85ce-3372cd623675"],
Cell[51397, 1459, 335, 8, 33, "Output",ExpressionUUID->"3a52f5e8-1773-4fbc-8697-747871ad7e6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51769, 1472, 188, 3, 29, "Input",ExpressionUUID->"37b5f4a4-5f02-4263-9d2b-f2248262d7c8"],
Cell[51960, 1477, 236, 6, 33, "Output",ExpressionUUID->"93a591b3-5e40-4ecf-a2ce-20b31634a214"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52233, 1488, 188, 3, 29, "Input",ExpressionUUID->"f17421e4-ce7c-46ae-974d-501c8d7f9359"],
Cell[52424, 1493, 198, 3, 33, "Output",ExpressionUUID->"b9c98edb-437f-4f5b-9210-7f7fdaa6362a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52659, 1501, 190, 3, 29, "Input",ExpressionUUID->"a69b84d0-95f1-48d5-bb79-a12917ea9f29"],
Cell[52852, 1506, 171, 3, 33, "Output",ExpressionUUID->"cb52c8f8-5284-48e5-a7c3-bdd86289fe7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53060, 1514, 342, 7, 49, "Input",ExpressionUUID->"2d9c4666-6550-4453-9165-3553b209910e"],
Cell[53405, 1523, 195, 3, 33, "Output",ExpressionUUID->"b6e59d95-c20f-4a02-b97d-4b6b216934a3"],
Cell[53603, 1528, 194, 3, 33, "Output",ExpressionUUID->"3bb1e08f-49eb-4cc9-bbdc-807bbdc5ecc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53834, 1536, 351, 8, 29, "Input",ExpressionUUID->"c4ba073a-ea22-4344-9e39-94e3dad8ee45"],
Cell[54188, 1546, 197, 3, 33, "Output",ExpressionUUID->"1c75c8e9-c29b-4605-b575-1b9d5c462440"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54422, 1554, 358, 8, 29, "Input",ExpressionUUID->"b12045ce-2c49-4dab-85aa-d99c474fa40e"],
Cell[54783, 1564, 196, 3, 33, "Output",ExpressionUUID->"66c9a803-b0a6-48f9-953c-a024ab0d103d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55016, 1572, 246, 6, 29, "Input",ExpressionUUID->"380d1a11-622d-4888-b134-ff63be01bf50"],
Cell[55265, 1580, 176, 3, 33, "Output",ExpressionUUID->"524de4a7-754d-4c27-92ce-88c4906a7d76"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55478, 1588, 249, 6, 29, "Input",ExpressionUUID->"851ca52d-35c5-489f-b485-e582cf4d3ea3"],
Cell[55730, 1596, 174, 3, 33, "Output",ExpressionUUID->"3a5a47a6-1fc1-4a0c-bdd1-47e99dcec50b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55953, 1605, 169, 3, 65, "Section",ExpressionUUID->"b8ed7642-33cb-48df-8fe1-73bc424cd27d"],
Cell[56125, 1610, 751, 19, 89, "Input",ExpressionUUID->"c7735443-6624-4f6b-97d8-2f2a42f7d1ca"],
Cell[56879, 1631, 378, 10, 49, "Input",ExpressionUUID->"d8dd4c17-c732-429d-877e-28d098eeeb7a"],
Cell[CellGroupData[{
Cell[57282, 1645, 233, 5, 29, "Input",ExpressionUUID->"c7ba10a5-6b5c-4008-b363-963074d4d23b"],
Cell[57518, 1652, 937, 32, 194, "Output",ExpressionUUID->"e2ff3b85-6ec2-4bcf-82f6-caea43b97639"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58492, 1689, 2178, 60, 135, "Input",ExpressionUUID->"2f22e0f5-db8a-4957-b4d0-10ce0335913b"],
Cell[60673, 1751, 1103, 33, 194, "Output",ExpressionUUID->"15df08e6-30b0-4697-86d0-ace7e25d952c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61813, 1789, 211, 4, 29, "Input",ExpressionUUID->"4f4829b8-1ce8-4956-9b3c-ecca13553d83"],
Cell[62027, 1795, 199, 5, 33, "Output",ExpressionUUID->"d7ae9527-5e3a-4027-ba2c-2640b4beb7c5"]
}, Open  ]],
Cell[62241, 1803, 1592, 43, 133, "Input",ExpressionUUID->"c7cd0ffd-97cf-4861-a0d7-8c0b63be08d4"],
Cell[63836, 1848, 782, 21, 69, "Input",ExpressionUUID->"a32c1309-1646-4f03-88c7-6acfc632da43"],
Cell[CellGroupData[{
Cell[64643, 1873, 221, 4, 29, "Input",ExpressionUUID->"195ad528-d4c0-4ece-946d-92766095ce5d"],
Cell[64867, 1879, 296, 9, 33, "Output",ExpressionUUID->"6ed06660-4f1c-43a0-a3e8-6df5feff6815"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65200, 1893, 256, 5, 29, "Input",ExpressionUUID->"e75be986-d961-41bc-802c-d68e3d82e26d"],
Cell[65459, 1900, 326, 9, 33, "Output",ExpressionUUID->"9867acc7-eb83-4176-88aa-ae6dee41d77b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65822, 1914, 483, 12, 49, "Input",ExpressionUUID->"cc2e8b0d-e871-45f9-99f9-fbefce7506f8"],
Cell[66308, 1928, 797, 21, 93, "Output",ExpressionUUID->"2facc855-52ad-44a9-9a08-201b9e4c781f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67142, 1954, 392, 11, 30, "Input",ExpressionUUID->"bd0c0a1a-fa82-4579-adb1-7734d65bd1cf"],
Cell[67537, 1967, 226, 5, 33, "Output",ExpressionUUID->"9cd48ce4-8f1e-4f52-b39f-900062911e8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67800, 1977, 1404, 37, 109, "Input",ExpressionUUID->"6f0f733e-a4ad-4737-bf28-c9b2c2b5996a"],
Cell[69207, 2016, 2314, 47, 194, "Output",ExpressionUUID->"6f1c3d5e-ca45-40aa-b496-52dd746465bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71558, 2068, 840, 24, 69, "Input",ExpressionUUID->"f9c4d9ed-b2f8-4235-9f20-355ad6f1a034"],
Cell[72401, 2094, 224, 5, 33, "Output",ExpressionUUID->"fef1f941-32d8-4ede-a029-0bee478bec5f"]
}, Open  ]],
Cell[72640, 2102, 2515, 69, 169, "Input",ExpressionUUID->"b5593ffb-9079-4999-a6b9-da076028281f"],
Cell[75158, 2173, 671, 19, 89, "Input",ExpressionUUID->"50763232-cb3b-48b0-adca-db1f59b47892"],
Cell[CellGroupData[{
Cell[75854, 2196, 1328, 34, 153, "Input",ExpressionUUID->"c23f0298-d646-44b0-9ef9-3794a952be2f"],
Cell[77185, 2232, 565, 12, 57, "Output",ExpressionUUID->"c165388d-ba04-4f5b-af9f-0918d1a07f1d"]
}, Open  ]]
}, Open  ]]
}
]
*)

